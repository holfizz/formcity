const XLSX = require('xlsx');
const fs = require('fs');

const testData = [
  ['Тип', 'Подтип', 'Площадь', 'Цена', 'Этаж', 'Комнаты', 'Очередь', 'Статус', 'Описание'],
  ['Квартира', '1-комнатная', 45, 3500000, 3, 1, '1 очередь', 'Доступна', 'Уютная квартира с видом на парк'],
  ['Квартира', '2-комнатная', 65, 5200000, 5, 2, '1 очередь', 'Доступна', 'Просторная квартира для семьи'],
  ['Квартира', '3-комнатная', 85, 6800000, 7, 3, '2 очередь', 'Бронь', 'Большая квартира с балконом'],
  ['Коммерческое', 'Офис', 120, 8500000, 1, 0, '1 очередь', 'Доступна', 'Офисное помещение в центре'],
  ['Коммерческое', 'Магазин', 80, 6000000, 1, 0, '1 очередь', 'Продана', 'Торговое помещение с витриной'],
  ['Квартира', '1-комнатная', 38, 3200000, 2, 1, '2 очередь', 'Доступна', 'Компактная студия'],
  ['Квартира', '2-комнатная', 72, 5800000, 8, 2, '2 очередь', 'Доступна', 'Квартира с панорамными окнами'],
  ['Коммерческое', 'Склад', 200, 4500000, 1, 0, '3 очередь', 'Планируется', 'Складское помещение'],
  ['Квартира', '4-комнатная', 110, 9200000, 9, 4, '2 очередь', 'Доступна', 'Элитная квартира с террасой'],
  ['Квартира', '2-комнатная', 58, 4800000, 4, 2, '1 очередь', 'Доступна', 'Квартира улучшенной планировки']
];

const wb = XLSX.utils.book_new();
const ws = XLSX.utils.aoa_to_sheet(testData);
XLSX.utils.book_append_sheet(wb, ws, 'Недвижимость');
XLSX.writeFile(wb, 'data.xlsx');

console.log('Тестовый Excel файл создан: data.xlsx');
console.log(`Добавлено ${testData.length - 1} записей недвижимости`);

if (fs.existsSync('data.xlsx')) {
  const stats = fs.statSync('data.xlsx');
  console.log(`Размер файла: ${stats.size} байт`);
  console.log(`Создан: ${stats.birthtime}`);
} else {
  console.error('Ошибка: файл не был создан');
}